Геометрия:Line sweeping
			от Съзтезателно програмиране
			
									Направо към: навигация, търсене			
			 if (window.showTocToggle) { var tocShowText = "показване"; var tocHideText = "скриване"; showTocToggle(); }   Увод 
Line sweeping техниката се използва за решаване на задачата, за определяне дали в дадено множество от отсечки има две, които се пресичат. Стандартният алгоритъм за решаване на тази задача е със сложност O(N^2), като проверява за пресечени точки всяка отсечка с всяка друга отсечка. Алгоритъмът работи със сложност O(NlogN), където N е броят на отсечките. Важно е да се отбележи, че намира само дали има някакво пресичане, а не изброява всичките такива. За улеснение ще наречем алгоритъмът Line-Segment-Intersection, а за краткост ще го означаваме с LSI.
В sweeping алгоритмите въображаема вертикална линия обхожда множество от геометрични обекти, обикновено от ляво на дясно. В този случай х координата на декартовата равнина се третира като време. Sweeping алгоритмите са начин за обхождане на множество от геометрични обекти и подреждането им в сложни структури от данни.
Долупредставеният алгоритъм допуска две неща за улеснение на изложението. Тези допускания с малки модификации могат да се отстранят, но това остава като упражнение. Първото е че няма вертикална отсечка, а второто е че никои три точки не се пресичат в една и съща точка.

  Подреждане на отсечките 
Тъй като допускаме, че няма вертикална отсечка, това ни дава гаранция се всяка отсечка пресича дадена вертикална sweep линия в най-много една точка(Защо?). Това ни дава възможност да подредим отсечки пресичащи дадена линия по у-координата на пресечката им с линията. Нека например разгледаме две отсечки s_1 и  s_2. Казваме, че те са сравними в дадено x, ако и двете пресичат sweep линията с х-координата х. Ако в дадено х s_1 и s_2 са сравними и при пресичането с линията s_1 e по-високо от s_2 записваме s_1 >(x) s_2. Релацията ">(x)" е тотална наредба за отсечките пресичащи sweep линията в х. При движението на sweep линията тази наредба се променя, когата линията срещне нова отсечка или достигне краят(десният край) на някой отсечка.
Какво става, когато sweep линията премине през пресечена точка на две отсечки? Ако линията срещне пресечката на отсечките u и v, то те променят разположението си подредбата. Ако u е било над v, сега ще стане под v и обратно. Поради допускането, че никои три отсечки не се пресичат в една точка, може да считаме, че "малко" преди пресичането u и v са били съседни в наредбата на отсечките.

  Местене на sweep линията 
Sweeping line алгоритмите се нуждаят от две структури от данни:

1. sweep-line status дава подредбата на обектите, които пресичат sweeping линията
2. event-point schedule е поредица от х-координати, сортирани отляво надясно, където настъпва промяна в наредбата. Това началните и крайните точки на отсечките.

Крайните точки се сортират във възходящ ред по х, като при равенство първо са левите крайни точки. При ново равенство избираме първо тези с по-ниска у-координата. Дадена отсечка вкарваме в sweep-line status структурата, когато срещнем лявата й крайна точка, и я изтриваме, когато срещнем дясната й крайна точка.
Sweep-line status е тоталната наредба T на отсечките и тя се нуждае от следните операции:

1. INSERT(T,s) - вмъква отсечка s
2. DELETE(T,s) - изтрива отсечка s
3. ABOVE(T,s) - връща отсечката над s в тоталната наредба
4. BELOW(T,s) - връща долната отсечка

Всички тези операции могат да се изпълнят със сложност O(logN), като се използват червено-черни дървета.

  Псевдокод на алгоритъма 
INTERSECT(S)
 T=[]
 сортираме точките в S както беше описано в горната секция
 for всяка точка p в сортирания списък от крайни точки
  if р е лява точка на отсечка s
   then INSERT(T,s)
    if ABOVE(T,s) съществува и пресича s или BELOW(T,s) съществува и пресича s
     then return TRUE
  if p  е дясна точка на отсечката s
   then if ABOVE(T,s) и BELOW(T,s) съществуват и се пресичат
    return TRUE
   DELETE(T,s)
 return FALSE

В случая S  е множеството от отсечките. Забележете, че при изтриване на отсечка трябва да се провери дали не се пресичат отсечките над и под нея. Това трябва да се направи, защото нямаме sweep линии на х-ове различни от крайните точки, а точно тогава пресичащите се отсечки са съседни. Така с тази проверка просто обхващаме случаят когато sweep линията е между две крайни точки.
От псевдокода очевидно следва, че ако имаме гарантирани O(logN) операции върху тоталната наредба T, но сложността на алгоритъма е O(NlogN)(Защо?).

  Заключение 
Sweeping алгоритмите са хубаво решение на различни геометрични задачи. Понякога идеята за обхождане на обекти с движеща се вертикална линия дава добри резултати. Не е препоръчително, обаче, горният алгоритъм да се ползва на места, където O(N^2) решението върши работа, защото е много по-лесно за писане, в сравнение с червено-черни дървета.

  Използвана литература 
Cormen, Leiserson, Rivest, Stein. Introduction to Algorithms. USA. MIT Press.





Взето от „http://judge.openfmi.net:9080/mediawiki/index.php/%D0%93%D0%B5%D0%BE%D0%BC%D0%B5%D1%82%D1%80%D0%B8%D1%8F:Line_sweeping“.
			Категории: Алгоритми | Геометрия			
						
		